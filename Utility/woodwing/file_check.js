var script_folder = Folder('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason');$.evalFile(script_folder+'/Utility/console.js');$.evalFile(script_folder+'/Utility/library.js');start_log();var filenames = ['Y40744_HB_RT Handbook_G1_TOC+Intro','Y40744_HB_RT Handbook_G1_U1','Y40744_HB_RT Handbook_G1_U2','Y40744_HB_RT Handbook_G1_U3','Y40744_HB_RT Handbook_G1_U4','Y40744_HB_RT Handbook_G1_U5','Y40744_HB_RT Handbook_G1_U6','Y40744_HB_RT Handbook_G1_U7','Y40744_HB_RT Handbook_G1_U8','Y40744_HB_RT Handbook_G1_U9','Y40744_HB_RT Handbook_G1_U10+AtAGlance', ];function process(){  var articles = document.managedArticles.everyItem().getElements();  articles.forEach(function(article){    try{      article.checkOut();    }catch(e){      log(e);    }      });  document.layoutWindows[0].zoomPercentage = 100;  }function post_process(){  document.viewPreferences.horizontalMeasurementUnits = MeasurementUnits.INCHES;  document.viewPreferences.verticalMeasurementUnits = MeasurementUnits.INCHES;  app.select(document.spreads.firstItem().pages.firstItem());  }function safe_open(filename){   var file_cap = 20;  if(app.documents.count() > file_cap){app.documents.everyItem().close(SaveOptions.no);}   var query = ['Name, '+filename.replace(/\.indd/, ''), 'Type, Layout'];  var results = app.queryObjects(query);    var id = !!results.match(/<\d+/) ? results.match(/<\d+/)[0].replace(/</g, '') : false;  // log(id);  if(!!id){    // app.openObject(id, true);  }else{    // alert('id returned false, file not found for filename: '+filename);    // throw 'exiting program';    log('id returned false, file not found for filename: '+filename);  }};(function(){  app.linkingPreferences.checkLinksAtOpen = false;  app.scriptPreferences.userInteractionLevel = UserInteractionLevels.INTERACT_WITH_ALL;  // notifications_off();  var pb = create_progress_bar('checking files', filenames.length, 150,150);    filenames.forEach(function(filename, x){        safe_open(filename);            // process();    // post_process();    // document.close(SaveOptions.no);    update_progress_bar(pb);  });  pb.close();  // notifications_on();})();end_log();