var script_folder = Folder('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason');$.evalFile(script_folder+'/Utility/console.js');$.evalFile(script_folder+'/Utility/library.js');start_log();var filenames = ['Y35600_TRS_IRA_G5_U10_L1','Y35600_TRS_IRA_G5_U10_L2','Y35600_TRS_IRA_G5_U10_L3','Y35600_TRS_IRA_G5_U10_L4','Y35600_TRS_IRA_G5_U10_L5','Y35600_TRS_IRA_G5_U10_L6',];function process(){  var articles = document.managedArticles.everyItem().getElements();  articles.forEach(function(article){    try{      article.checkOut();    }catch(e){      log(e);    }      });  document.layoutWindows[0].zoomPercentage = 100;  }function post_process(){  document.viewPreferences.horizontalMeasurementUnits = MeasurementUnits.INCHES;  document.viewPreferences.verticalMeasurementUnits = MeasurementUnits.INCHES;  app.select(document.spreads.firstItem().pages.firstItem());  }function safe_open(filename){   var file_cap = 20;  if(app.documents.count() > file_cap){app.documents.everyItem().close(SaveOptions.no);}   var query = ['Name, '+filename, 'Type, Layout'];  var results = app.queryObjects(query);    var id = !!results.match(/<\d+/) ? results.match(/<\d+/)[0].replace(/</g, '') : false;  log(id);  if(!!id){    app.openObject(id, true);    // app.openObject(id);  }else{    alert('id returned false, file not found for filename: '+filename);    throw 'exiting program';      }};function myCreateProgressPanel(myMaximumValue, myProgressBarWidth){  myProgressPanel = new Window('window');  with(myProgressPanel){    myProgressPanel.myProgressBar = add('progressbar', [12, 12, myProgressBarWidth, 64], 0, myMaximumValue);  }  return myProgressPanel;}(function(){      app.linkingPreferences.checkLinksAtOpen = false;  // app.scriptPreferences.userInteractionLevel = UserInteractionLevels.INTERACT_WITH_ALL;  notifications_off();  var myProgressPanel = myCreateProgressPanel(filenames.length, 640);  myProgressPanel.show();  filenames.forEach(function(filename, x){    myProgressPanel.myProgressBar.value = x;    myProgressPanel.active = true;    safe_open(filename);            // process();    // post_process();    // document.close(SaveOptions.no);  });  myProgressPanel.myProgressBar.value = 0;  myProgressPanel.close();  // notifications_on();})();end_log();