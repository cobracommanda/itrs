//  ____                _         _             _       _                             _____           _         _                          _             // |  _ \ ___  __ _  __| |_   _  | |_ ___      / \   __| |_   ____ _ _ __   ___ ___  | ____|__ _ _ __| |_   _  | |    ___  __ _ _ __ _ __ (_)_ __   __ _ // | |_) / _ \/ _` |/ _` | | | | | __/ _ \    / _ \ / _` \ \ / / _` | '_ \ / __/ _ \ |  _| / _` | '__| | | | | | |   / _ \/ _` | '__| '_ \| | '_ \ / _` |// |  _ <  __/ (_| | (_| | |_| | | || (_) |  / ___ \ (_| |\ V / (_| | | | | (_|  __/ | |__| (_| | |  | | |_| | | |__|  __/ (_| | |  | | | | | | | | (_| |// |_| \_\___|\__,_|\__,_|\__, |  \__\___/  /_/   \_\__,_| \_/ \__,_|_| |_|\___\___| |_____\__,_|_|  |_|\__, | |_____\___|\__,_|_|  |_| |_|_|_| |_|\__, |//                        |___/                                                                         |___/                                      |___/ //CREATOR JY//CREATED 2018-08-06//UPDATED 2018-08-06//VERSION 1.0var script_folder = Folder('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason');$.evalFile(script_folder+'/Utility/console.js');$.evalFile(script_folder+'/Utility/library.js');start_log();var project_folder = Folder('/Volumes/BEC/15 User Files/INDD SCRIPTS/primitive/_JY_BU/JasonONE_DRIVE_UNSORTED/OneDrive - Benchmark Education/projects/ready_to_advance_early_learning/itrs');var output_folder = Folder(project_folder+'/output');var current_package_folder, current_images_path, current_grade, current_unit, current_week, current_day, current_lesson, current_color;var filenames = [];// var pwc_xcode = 'X43851';function process(){	var links = document.links.everyItem().getElements();	links.forEach(function(link){						try{			if(link.status != LinkStatus.NORMAL){				log(document.name+' - '+link.name+' - '+link.filePath);				auto_relink(link);						}		}catch(e){			log('WARNING: cannot relink '+link.name);			}			});}function auto_relink(link){	var image_file = File(/Volumes/+link.filePath.replace(/\:/g, '/'));		var image_name = image_file.name.replace(/(X|Y)\d+_/, '');	var folder = Folder(image_file.path);	var files = folder.getFiles('*.jpg');	files.forEach(function(file){		if(file.name.replace(/(X|Y)\d+_/, '') == image_name){			var path = folder+'/'+file.name;			link.relink(File(path));			log('SUCCESS: relinked '+image_name+' in '+document.name);			return true;		}	});} function safe_open(filename){   if(app.documents.count() > 20){app.documents.everyItem().close(SaveOptions.no);}   var query = ['Name, '+filename, 'Type, Layout'];  var results = app.queryObjects(query);  // results = !!results.match(/<\d+.*?>/) ? results.match(/<\d+.*?>/)[0] : false;  var id = !!results.match(/<\d+/) ? results.match(/<\d+/)[0].replace(/</g, '') : false;  if(!!id){    app.openObject(id, true);  }else{    alert('id returned false, file not found for filename: '+filename);	  throw 'exiting program';  }};function myCreateProgressPanel(myMaximumValue, myProgressBarWidth){	myProgressPanel = new Window('window');	with(myProgressPanel){		myProgressPanel.myProgressBar = add('progressbar', [12, 12, myProgressBarWidth, 64], 0, myMaximumValue);	}	return myProgressPanel;}(function(){			// app.linkingPreferences.checkLinksAtOpen = false;	// app.scriptPreferences.userInteractionLevel = UserInteractionLevels.INTERACT_WITH_ALL;	// // notifications_off();	// var myProgressPanel = myCreateProgressPanel(filenames.length, 640);	// myProgressPanel.show();	// filenames.forEach(function(filename, x){	// 	myProgressPanel.myProgressBar.value = x;	// 	myProgressPanel.active = true;	// 	safe_open(filename);				process();			// 	// document.close(SaveOptions.no);	// });		// myProgressPanel.myProgressBar.value = 0;	// myProgressPanel.close();	// // notifications_on();})();end_log();