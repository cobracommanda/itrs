//CREATOR JY//CREATED 2017-01-18//UPDATED 2017-03-30//VERSION 1.5$.evalFile('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason/Utility/console.js');$.evalFile('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason/Utility/exporter.js');start_log();// alert('Select a CSV file');// var data_file = File.openDialog();var data_file;var map;  function create_html(table){	var grade = table[0][0];	var html = create_file(data_file.parent.parent.fsName+'/Grade'+grade+'.xml');			var grade_type = !!grade.toString().match(/\d/) ? 'Grade '+grade : 'Kindergarten';	var text = '';	text += '<?xml version="1.0" encoding="UTF-8"?>\r';	text += '<Grade type="'+grade_type+'" code="'+grade+'">\r';	var category = false;		var list = false;		var l = table.length;	for(var x = 1; x < l; x++){		var row = table[x];				var rl = row.length;		for(var y = 0; y < rl; y++){			var cell = row[y];			cell = cell.replace(/&#44;/g, ',').replace(/^\s*/, '').replace(/\s*$/, '');						if(cell == ''){continue;}			var code = cell.replace(/\s.*$/, ''); 			var info = cell.replace(/^(\w|\.)*\s/, '');											switch(y){				case 0: 					info = format(info);										if(!!category){ if(!!list){text += '\t\t</list>\r';} text += '\t</Category>\r'; list = false; }else{ category = true; }					// for OK					info = !!category ? cell : info;					code = !!category ? cell.match(/\d+/)[0] : cell;					// end for OK					text += '\t<Category type="'+info+'" code="'+code+'">\r';				break;				case 1: 					if(!!list){ text += '\t\t</list>\r'; }else{ list = true; }					text += '\t\t<list title="'+cell+'">\r'; 				break;				default:					text += '\t\t\t<standard code="'+code+'">'+info+'</standard>\r';			}		}	}	text += '\t\t</list>\r';	text += '\t</Category>\r';	text += '</Grade>\r';	html.open('w');	html.write(text);	html.close();}function format(string){	var text = string;	text = text.toLowerCase();		var array = text.split('');	var l = array.length;	for(var x = 0; x < l; x++){		var character = array[x];		if(x == 0){			array[x] = array[x].toUpperCase();		}		if(character == ' ' && x != l-1){			array[x+1] = array[x+1].toUpperCase();		}	}		text = array.join('');	return text;} function get_data(csv_file){  var data, row;    data = [];     csv_file.open('r');    while(!csv_file.eof){      row = csv_file.readln().split(',');       // log(row);         data.push(row);    };    csv_file.close();    return data;  }   (function(){ 	var data_folder = Folder('/Volumes/BEC/15 User Files/INDD SCRIPTS/primitive/_JY_BU/JasonONE_DRIVE_UNSORTED/OneDrive - Benchmark Education/projects/standards/Oklahoma/csv/').getFiles('*.csv');	var l = data_folder.length;	for(var x = 0; x < l; x++){		data_file = data_folder[x];		try{		create_html(get_data(data_file));		}catch(e){}	}	})();alert('Complete!');end_log();