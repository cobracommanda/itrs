$.evalFile('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason/Utility/console.js');start_log();$.evalFile('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason/Utility/library.js');var template_with_4rows = File('/Volumes/BEC/15 User Files/INDD SCRIPTS/primitive/_JY_BU/JasonONE_DRIVE_UNSORTED/OneDrive - Benchmark Education/projects/add_hoc/templates/4 row template.indd');var template_with_5rows = File('/Volumes/BEC/15 User Files/INDD SCRIPTS/primitive/_JY_BU/JasonONE_DRIVE_UNSORTED/OneDrive - Benchmark Education/projects/add_hoc/templates/5 row template.indd');var indd_folders = [	Folder('/Volumes/BEC/15 User Files/INDD SCRIPTS/primitive/_JY_BU/JasonONE_DRIVE_UNSORTED/OneDrive - Benchmark Education/projects/add_hoc/indd'),];function process_folders(folders){  var l = folders.length;  for(var x = 0; x < l; x++){    var folder = folders[x];    var files = folder.getFiles('*.indd');    process_files(files);  }}function process_files(files){  var l = files.length;  for(var x = 0; x < l; x++){    var file = files[x];     process_file(file);   }}function process_file(file){      app.open(file);  process_collection(get_collection());  // document.close(SaveOptions.no);} function get_collection(){	var collection = [];	var spreads = document.spreads.everyItem().getElements();	spreads.forEach(function(spread){		var object_info = {			spread_ref: spread,			total_rows: get_number_of_rows(spread)		}		collection.push(object_info);	});	return collection;}function get_number_of_rows(spread){	var table = get_table(spread);	return !table ? false : table.rows.length-1;}function get_table(spread){	var table = false;	var textFrames = spread.textFrames.everyItem().getElements();	textFrames.forEach(function(textFrame){				if(textFrame.tables.length == 1){ table = textFrame.tables.firstItem(); }	});	return table;	}function get_master_spread(rows){	var spread = false;	switch(true){		case(!rows): spread = false; break;		case(rows == 4): spread = document.masterSpreads[document.masterSpreads.length-1]; break;		case(rows == 5): spread = document.masterSpreads[document.masterSpreads.length-2]; break;		default: log('WARNING: out of bounds for number of rows: '+rows);	}			return spread;}function process_collection(collection){	collection.forEach(function(object_info){		log(object_info.spread_ref.pages[0].name+' - '+object_info.total_rows);		var master_spread = get_master_spread(object_info.total_rows);		if(!!master_spread){			document.spreads.add(LocationOptions.BEFORE, object_info.spread_ref, {appliedMaster: master_spread});		}	});}(function(){	notifications_off();	process_folders(indd_folders);	notifications_on();})();end_log();