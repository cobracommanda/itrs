$.evalFile('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason/Utility/console.js');$.evalFile('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason/Utility/library.js');start_log();var indd_folder = Folder.selectDialog();// var indd_filenames = [// 'Y34859_U1_FM',// 'Y34859_U1W1_WeeklyIntro',// 'Y34859_U1_TABS',// 'Y34859_U1W1_Interleaf',// 'Y34859_U1W1D1',// 'Y34859_U1W1D2',// 'Y34859_U1W1D3',// 'Y34859_U1W1D4',// 'Y34859_U1W1D5',// 'Y34859_U1W2_WeeklyIntro',// 'Y34859_U1W2_Interleaf',// 'Y34859_U1W2D1',// 'Y34859_U1W2D2',// 'Y34859_U1W2D3',// 'Y34859_U1W2D4',// 'Y34859_U1W2D5',// 'Y34859_U1W3_WeeklyIntro',// 'Y34859_U1W3_Interleaf',// 'Y34859_U1W3D1',// 'Y34859_U1W3D2',// 'Y34859_U1W3D3',// 'Y34859_U1W3D4',// 'Y34859_U1W3D5',// 'Y34859_U1W4_LL',// 'Y34859_U1W4_MS',// 'Y34859_U1_TRS_AR',// ];Array.prototype.forEach = function(callback){  var l = this.length;  for(var x = 0; x < l; x++){    if(!!callback){callback(this[x], x);}  }};  function process_folder(folder){	var files = folder.getFiles('*.indd');	files.forEach(function(file, x){		app.open(file);		process_file();		document.close(SaveOptions.no);	});}function process_filenames(filenames){	filenames.forEach(function(filename){		open_from_woodwing(filename);		process_file();		document.close(SaveOptions.no);	});}function process_file(){					check_fonts();	check_links();	}function check_fonts(){	var fonts = document.fonts.everyItem().getElements();	fonts.forEach(function(font){		var status = false;				switch(font.status){			case FontStatus.SUBSTITUTED: status = 'SUBSTITUTED'; break;			case FontStatus.NOT_AVAILABLE: status = 'NOT_AVAILABLE'; break;			case FontStatus.UNKNOWN: status = 'UNKNOWN'; break;			case FontStatus.FAUXED: status = 'FAUXED'; break;		}				if(!!status){			log(document.name+'\t'+'font\t'+font.name.replace(/\t/ig, ' ') +'\t'+status);		}	});}function check_links(){	var links = document.links.everyItem().getElements();	links.forEach(function(link){		try{			var status = false;			switch(link.status){				case LinkStatus.LINK_MISSING: status = 'LINK_MISSING'; break;				case LinkStatus.LINK_INACCESSIBLE: status = 'LINK_INACCESSIBLE'; break;				case LinkStatus.LINK_OUT_OF_DATE: status = 'LINK_OUT_OF_DATE'; break;			}					if(!!status){				log(document.name+'\t'+'image\t'+link.name.replace(/\t/ig, ' ') +'\t'+status+'\t'+link.filePath);			}			}catch(e){			log('WARNING: status not found for link: ' + link.name);		}	});}(function(){		notifications_off();		timer_off = true;	process_folder(indd_folder);	// process_filenames(indd_filenames);	timer_off = false;	notifications_on();})();end_log();