//CREATOR EF//CONTRIBUTOR JY//CREATED 2018-02-13//UPDATED 2018-02-13//VERSION 1.1$.evalFile('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason/Utility/console.js');start_log();var python_folder = create_folder('/Users/jyim/Desktop/python');var output_folder = create_folder(python_folder+separator+'product_data');var input_codes = ['Y34752'];Array.prototype.forEach = function(callback){  var l = this.length;  for(var x = 0; x < l; x++){    if(!!callback){callback(this[x], x);}  }};function getMeta(codes) {  var filename = 'getJSON.py';  var py = new File(output_folder+separator+filename);  py.open('w');  py.encoding = 'UTF-8';  var termfile = create_file(output_folder+separator+'command.term');  var python = '';  python += 'import urllib\r';  python += 'file = open("data.json","w")\r';  python += 'file.write("""[\\n""")\r';  python += 'file.close()\r';  codes.forEach(function(code, x){    if(x > 0){ python += 'file.write(""",\\n""")\r'; }    python += 'link = "https://mia.benchmarkconnect.com/api/freeandclear/Vn1f6H3sq7n2kFD/sibling_components?codes=' + code + '"\r';    python += 'f = urllib.urlopen(link)\r';    python += 'myfile = f.read()\r';    python += 'file = open("data.json","a")\r';    python += 'file.write(myfile)\r';    });    python += 'file.write("""]\\n""")\r';  python += 'file.close()\r';  py.write(python);  py.close();  var command = 'cd ~/Desktop/python/product_data; python '+filename;  termfile.open('w');  termfile.writeln(    '<?xml version="1.0" encoding="UTF-8"?>\n' +    '<!DOCTYPE plist PUBLIC "-//Apple Computer//DTD PLIST 1.0//EN"' +    '"http://www.apple.com/DTDs/PropertyList-1.0.dtd">\n' +    '<plist version="1.0">\n' +    '<dict>\n' +    '<key>WindowSettings</key>\n' +    '<array>\n' +    '<dict>\n' +    '<key>CustomTitle</key>\n' +    '<string>My first termfile</string>\n' +    '<key>ExecutionString</key>\n' +    '<string>' + command + '</string>\n' +    '</dict>\n' +    '</array>\n' +    '</dict>\n' +    '</plist>\n');  termfile.close();  termfile.execute();}(function(){  getMeta(input_codes);})();end_log();