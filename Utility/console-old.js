//CREATOR JASON YIM//CREATED 2016-10-21//UPDATED 2019-04-04//VERSION 2.1var separator = '/'; if(File.fs == 'Windows'){separator = '\\';}var log_file = create_file('/Volumes/BEC/15 User Files/INDD SCRIPTS/primitive/_JY_BU/JasonONE_DRIVE_UNSORTED/OneDrive - Benchmark Education'+separator+'logs'+separator+'log.txt');var start_time = new Date().getTime();	var position;var timer_off = true;function elapsed_time(){  var text = '';  text += ' (';  var time_in_seconds = ((new Date().getTime()-start_time)/1000);  // var time_in_minutes = (Math.round(time_in_seconds/60));  // var time_in_hours = (Math.round(time_in_minutes/60));  // var minutes_remainder = Math.round((time_in_minutes >= 60 ? time_in_minutes % 60 : time_in_minutes)*1000)/1000;  // var seconds_remainder = Math.round((time_in_seconds >= 60 ? time_in_seconds % 60 : time_in_seconds)*1000)/1000;  return text+time_in_seconds+'s)';}function create_folder(path){  var folder = Folder(path);   if(!folder.exists){folder.create();}  return folder;}function create_file(path){  var file = new File(path);  file.encoding = 'UTF-8';  file.lineFeed = 'Unix';  return file;}function notifications_off(){  app.linkingPreferences.checkLinksAtOpen = false;  app.scriptPreferences.userInteractionLevel = UserInteractionLevels.NEVER_INTERACT;}function notifications_on(){  app.linkingPreferences.checkLinksAtOpen = true;  app.scriptPreferences.userInteractionLevel = UserInteractionLevels.INTERACT_WITH_ALL;}function log(string){ log_file.writeln( ( !!position ? position : '' ) + string + ( !!timer_off ? '' : elapsed_time() ) ); }function getFullDate(date){ return date.getFullYear() +'-'+getMonth(date)+'-'+getDate(date); }function getMonth(date){ return date.getMonth()+1 < 10 ? '0'+(date.getMonth()+1) : date.getMonth()+1; }function getDate(date){ return date.getDate() < 10 ? '0'+date.getDate() : date.getDate(); }function getTime(date){ return getHours(date)+':'+getMinutes(date)+':'+getSeconds(date); }function getHours(date){ return date.getHours() < 10 ? '0'+date.getHours() : date.getHours(); }function getMinutes(date){ return date.getMinutes() < 10 ? '0'+date.getMinutes() : date.getMinutes(); }function getSeconds(date){ return date.getSeconds() < 10 ? '0'+date.getSeconds() : date.getSeconds(); }function start_log(file){  log_file = !!file ? file : log_file;  log_file.open('a');  var user = !!app.activeScript.fsName.match(/\/Users\/\w+/) ? app.activeScript.fsName.match(/\/Users\/\w+/)[0].replace(/\/Users\//, '') : false;  log('');  timer_off = false;  var date = new Date();  log( app.activeScript.name+' Started!' + ( !!user ? ' by User: ' + user : '' ) +' - '+ getFullDate(date) + ' - ' + getTime(date) );}function end_log(){  var time = 10;  var date = new Date();    if(!!Folder('/Volumes/BEC/15 User Files/INDD SCRIPTS/primitive/_JY_BU/JasonONE_DRIVE_UNSORTED/OneDrive - Benchmark Education').exists){    app.activeScript.copy(File('/Volumes/BEC/15 User Files/INDD SCRIPTS/primitive/_JY_BU/JasonONE_DRIVE_UNSORTED/OneDrive - Benchmark Education/Scripts/Scripts Panel'+get_script_path(app.activeScript)));  }    log( app.activeScript.name+' Completed! - '+ getFullDate(date) + ' - ' + getTime(date) );  log_file.close();  if(((new Date().getTime()-start_time)/1000) > time){    alert('Completed!');  }  function get_script_path(script){    var path = '/';    var folders = [];    var parent_folder = script.parent;        while(parent_folder.name != 'Scripts%20Panel'){                  folders.push(parent_folder.name);            parent_folder = parent_folder.parent;          }        if(folders.length > 0){       folders.reverse();      var l = folders.length;      for(var x = 0; x < l; x++){        var folder = folders[x];        path += folder+'/'      }          }        path += script.name;    // log(path);    return path;  }}function error_message(message){    log('ERROR: '+message);  throw 'stopping script';}function warning_message(message){  log('WARNING: '+message);}