//CREATOR JY//CREATED 2017-10-05//UPDATED 2017-10-06//VERSION 1.0$.evalFile('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason/Utility/console.js');start_log(); var indd_folder = Folder.selectDialog('Select a Folder with InDesign documents');var assignment_name = 'Assignments';var content_folder;function process_document(){		var document_name = document.name.replace(/\.\w+$/, '');	if(!File(indd_folder.fsName+separator+document_name+separator+assignment_name+'.icma').exists){		document.assignments.add({filePath: indd_folder.fsName+separator+document_name+separator+assignment_name+'.icma'});	}else{		log('WARNING: Assignments already exists at that location.');	}	content_folder = create_folder(indd_folder.fsName+separator+document_name+separator+'content');	var pages = document.pages;	var l = pages.length;	for(var x = 0; x < l; x++){		var page = pages[x];		process_textFrames(page);	}}function process_textFrames(page){	var document_name = document.name.replace(/\.\w+$/, '');	var textFrames = page.textFrames;	var l = textFrames.length;	for(var x = 0; x < l; x++){		var textFrame = textFrames[x];		var index = x+1;		var name = document_name+'_page'+page.name+'_'+textFrame.constructor.name+'_'+index;		var file = create_file(content_folder+separator+name+'.icml');		try{			textFrame.exportFile(ExportFormat.INCOPY_MARKUP, file);			var assignment = document.assignments.itemByName(assignment_name);			document.assignments.lastItem().assignedStories.lastItem().move(LocationOptions.AT_END, assignment);		}catch(e){			log('WARNING: textFrame'+index+' already exists.');		}	}}function process_indd_folder(){	var files = indd_folder.getFiles('*.indd');	var l = files.length;	for(var x = 0; x < l; x++){		var file = files[x];		process_file(file);	}}function process_file(file){	app.open(file);	process_document();	// document.close(SaveOptions.yes);}(function(){		notifications_off();	process_indd_folder();				notifications_on();})();end_log();