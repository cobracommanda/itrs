//CREATOR JY//CREATED 2017-06-22//UPDATED 2017-07-05//VERSION 1.1try{	$.evalFile('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason/Utility/console.js');}catch(e){		$.evalFile('/Volumes/user_files/User Files/0 - SCRIPTS/digitalReader/scripts/console.js');	}start_log();var folder = Folder.selectDialog('Select folder with Excel files');function applescript(folder){	var text = '';		text += 'set xls_files to {}\r';	var files = folder.getFiles('X*.xlsx');	files.sort(function(a, b){		return parseInt(a.name.replace(/_/g, '')) > parseInt(b.name.replace(/_/g, ''));	});	var l = files.length;	for(var x = 0; x < l; x++){		var file = files[x];		log(file.name);		text += 'set end of xls_files to "Macintosh HD'+folder.fsName.replace(/\//g, ':')+':'+file.name+'" as alias\r';	}			text += 'set outputDirectory to (choose folder with prompt "Select Output Folder")\r';		text += 'repeat with theFile in xls_files\r';	text += '	tell application "Microsoft Excel"\r';		text += '		activate\r';			text += '		close workbooks\r';			text += '		open theFile\r';		text += '		set theWorksheet to worksheet 1 of active workbook\r';	text += '		activate object theWorksheet\r';	text += '		set fileName to name of (info for theFile)\r';	text += '		set fileName to text 1 thru -6 of fileName\r';	text += '		set theSheetsPath to outputDirectory & fileName & ".csv" as string\r';	text += '		save as theWorksheet filename theSheetsPath\r';	text += '		save as theWorksheet filename theSheetsPath file format CSV file format with overwrite\r';	text += '		close active workbook saving no\r';	text += '	end tell\r';	text += 'end repeat\r';	app.doScript(text, ScriptLanguage.APPLESCRIPT_LANGUAGE);}(function(){	 	applescript(folder);})();alert('Complete');end_log();