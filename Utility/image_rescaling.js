//CREATOR JY//CREATED 2017-06-22//UPDATED 2019-02-07//VERSION 1.1$.evalFile('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason/Utility/console.js');start_log();$.evalFile('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason/Utility/library.js');$.evalFile('/Users/' + $.getenv('USER') + '/Library/Preferences/Adobe InDesign/Version 11.0/en_US/Scripts/Scripts Panel/team scripts/Jason/Utility/exporter.js');var input_folder = Folder.selectDialog();function place_images(){		app.documents.add();	var files = input_folder.getFiles('*.jpg');	files.forEach(function(file){		var page = document.pages.firstItem();		var rectangle = page.rectangles.add();		rectangle.place(file, true);		rectangle.fit(FitOptions.FRAME_TO_CONTENT);		rectangle.strokeWeight = 0;	});}function resize_and_export(){	document.viewPreferences.horizontalMeasurementUnits = MeasurementUnits.PIXELS;  document.viewPreferences.verticalMeasurementUnits = MeasurementUnits.PIXELS;  app.activeWindow.transformReferencePoint = AnchorPoint.CENTER_ANCHOR;  document.viewPreferences.rulerOrigin = RulerOrigin.SPREAD_ORIGIN;  document.zeroPoint = [0,0];	document.layoutWindows[0].viewDisplaySetting = ViewDisplaySettings.HIGH_QUALITY;	var rectangles = document.pages[0].rectangles;	set_jpg_export_preferences_to_best();	var l = rectangles.length; 	for(var x = 0; x < l; x++){		var rectangle = rectangles[x];		var filename = rectangle.allGraphics[0].itemLink.name;		var width = rectangle.geometricBounds[3] - rectangle.geometricBounds[1];		var height = rectangle.geometricBounds[2] - rectangle.geometricBounds[0];		var desired_width = 150;		rectangle.geometricBounds = [0, 0, (height/width)*desired_width, desired_width];		rectangle.fit(FitOptions.CONTENT_TO_FRAME);		export_image(rectangle, filename.replace(/\.jpg/, '_resized.jpg'), input_folder);	} 	document.close(SaveOptions.no);}(function(){	if(!input_folder.exists){return;}	place_images();	resize_and_export();})();end_log();