//for BA2.5var outputfile = File(app.activeScript.parent.fsName + '/smallgrouptablefinder_output.tsv');outputfile.open('a');var myWorkFolder = Folder.selectDialog('Point me to a directory of BA2(.5) INDDS! This script WILL go through subfolders!');// var myFiles = myWorkFolder.getFiles("*.indd");var myFiles = [];GetSubFolders(myWorkFolder);for(var f = 0; f < myFiles.length; f++){  var file = myFiles[f];  app.open(file);  var doc = app.activeDocument;  var found = false;  for(var pg = 0; pg < doc.pages.length; pg++)  {    var tfs = getTextFrames(doc.pages[pg]);    for(var t = 0; t < tfs.length; t++)    {      if(tfs[t].label.match(/lesson/i))      {        for(var p = 0; p < tfs[t].paragraphs.length; p++)        {          var para = tfs[t].paragraphs[p];          if(para.tables.length > 0)          {            if(para.tables[0].cells[0].paragraphs[0].appliedParagraphStyle.name.match(/Small_group_A-hd/i))            {              var grade = file.name.match(/G\w/)[0].replace(/G/, '');              var unit = file.name.match(/U\w/)[0].replace(/U/, '');              var week = file.name.match(/W\w/)[0].replace(/W/, '');              var day = grade.match(/[K12]/) ? file.name.match(/D\w/)[0].replace(/D/, '') : 'X';              var lesson = file.name.match(/L\d+\D/)[0].replace(/\D/g, '');              outputfile.writeln(grade+'\t'+unit+'\t'+week+'\t'+day+'\t'+lesson);              found = true;            }          }          if(found) p = tfs[t].paragraphs.length;        }      }      if(found) t = tfs.length;    }    if(found) pg = doc.pages.length;  }  doc.close(SaveOptions.NO);}outputfile.close();alert('Done!');//FUNCTIONSsfunction getTextFrames(pageToUse) {    var allframes = pageToUse.allPageItems;    var tfs = [];    for (var af = 0; af < allframes.length; af++)     {        if (allframes[af] instanceof TextFrame)         {          allframes[af].name = allframes[af].label;            tfs.push(allframes[af]);        }    }    return tfs;}function GetSubFolders(theFolder) {  if (!(theFolder.name.match(/old$/i)) && !(theFolder.name.match(/rrhtml$/i)))  {       var myFileList = theFolder.getFiles();         for (var i = 0; i < myFileList.length; i++)        {              var myFile = myFileList[i];              if (myFile instanceof Folder)            {                   GetSubFolders(myFile);              }              else if (myFile instanceof File && myFile.name.match(/\.indd$/i) /*&& myFile.path.match(/grade[345]/)*/)             {                   myFiles.push(myFile);              }         }     }}